<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <script src="./js/float-panel.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Aleo&family=Inter:wght@300;400;500;800&family=Manrope:wght@200;300;400;500;600;700;800&family=Poppins:ital,wght@0,300;0,400;0,500;1,300;1,400&family=Roboto:ital,wght@0,100;0,300;0,400;0,500;0,700;0,900;1,100;1,300;1,400;1,500;1,700;1,900&display=swap"
      rel="stylesheet"
    />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN"
      crossorigin="anonymous"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
      crossorigin="anonymous"
    ></script>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />
    <link rel="stylesheet" href="./css/styles.css" />
    <title>DVC ID Generator</title>
  </head>
  <body>
    <header class="mb-5 ">
      <nav>
        <div class="container p-2 position-relative">
          <h3 class="text-center head-title slideanim">DVC ID EDITOR</h3>
          <button  type="button" class="btn btn-info slideanim" data-bs-toggle="modal" data-bs-target="#exampleModal" style="position: absolute; right: 0; top:21%">Instruction</button>
        </div>
      </nav>
    </header>
    <div class="container " style="margin-bottom: 100px;">
      <div class="row">
        <div class="col-md-4 details-card ">
          <h3>
            Student Details &nbsp&nbsp&nbsp&nbsp&nbsp<i
              class="bi bi-circle-fill"
              style="color: green; font-size: 15px"
              ><span> VALID</span></i
            >
            <i class="bi bi-circle-fill" style="color: red; font-size: 15px"
              ><span> INVALID</span></i
            >
          </h3>
          <div class="input-group">
            <label for="fullname">Full name</label>
            <input
              type="text"
              class="input-details"
              name="fullname"
              id="fullname"
              required
            />
          </div>
          <div class="input-group">
            <label for="idnumber">Id number</label>
            <input
              type="number"
              class="input-details"
              name="idnumber"
              id="idnumber"
              required
            />
          </div>
          <div class="input-group">
            <label for="bday">Birthday</label>
            <!-- <input type="date" class="input-details" name="bday" id="bday" /> -->
            <input
              type="text"
              class="input-details"
              name="bday"
              id="bday"
              pattern="^[a-zA-Z]+\s\d{1,2},\s\d{4}$"
              placeholder="(e.g., August 30, 1999)"
              oninput="validateBirthday(event)"
              maxlength="20"
              required
            />
          </div>

          <div class="input-group">
            <label for="guardian">Guardian's name</label>
            <input
              type="text"
              class="input-details"
              name="guardian"
              id="guardian"
              onkeydown="return isAlphabetic(event)"
              required
            />
          </div>
          <div class="input-group">
            <label for="contactnumber">Contact Number</label>
            <input
              type="tel"
              class="input-details"
              name="contactnumber"
              id="contactnumber"
              placeholder="(e.g., 0900-000-0000)"
              pattern="[0-9]{4}-[0-9]{3}-[0-9]{4}"
              required
            />
          </div>
          <div class="input-group">
            <label for="school-year">School-Year</label>
            <input
              type="text"
              class="input-details"
              name="school-year"
              id="school-year"
              required
            />
          </div>
          <div class="input-group">
            <label for="semester">Semester</label>

            <select
              name="semester"
              class="input-details"
              id="semester"
              required
            >
              <option value="First Semester">First Semester</option>
              <option value="Second Semester">Second Semester</option>
            </select>
          </div>
          <div class="input-group">
            <label for="course">Course</label>
            <select name="course" class="input-details" id="course" required>
              <option value="BS - Information Technology">
                BS - Information Technology
              </option>
              <option value="B - Secondary Education">
                B - Secondary Education
              </option>
              <option value="B - Elementary Education">
                B - Elementary Education
              </option>
              <option value="B - Arts in Theology">B - Arts in Theology</option>
            </select>
          </div>
          <!-- <div class="input-group">
            <label for="">Student Image </label>
            <input type="file" id="studentImage"  required/>
          </div>
          <div class="input-group">
            <label for="signatureImage">Signature Image </label>
            <input type="file" id="signatureImage"   required/>
          </div> -->

          <div  class="input-group drop-area d-none"  
          ondragover="handleDragOver(event)"
          ondragleave="handleDragLeave(event)"
          ondrop="handleDrop(event, 'studentImage')">
            <label for="studentImage">Student Image</label>
            <div
              id="studentImageDrop"
             
            >
              <p>Drag and drop or click to upload</p>
            </div>
            <input
              type="file"
              id="studentImage"
              style="display: none"
              onchange="handleFiles(this.files, 'studentImage')"
            />
          </div >

          <div class="input-group drop-area d-none"  
          ondragover="handleDragOver(event)"
          ondragleave="handleDragLeave(event)"
          ondrop="handleDrop(event, 'signatureImage')">
            <label for="signatureImage">Signature Image</label>
            <div
              id="signatureImageDrop"
            
            >
              <p>Drag and drop or click to upload</p>
            </div>
            <input
              type="file"
              id="signatureImage"
              style="display: none"
              onchange="handleFiles(this.files, 'signatureImage')"
            />
          </div>
          <div class="row d-flex justify-content-between " style="width: 105%;">
         
           <div class="col text-center p-2">
            <label for="" class="mb-1">Student Image</label>
            <div class="drop-zone" data-display-element-id="previewStudentImagedrag">
             
              <span class="drop-zone__prompt">Drop file here or click to upload</span>
              <input type="file" name="myFile" class="drop-zone__input" id="dragstudentimage">
            </div>
           </div>
          <div class="col text-center p-2"> 
            <label for="" class="mb-1">Student Signature</label>
            <div class="drop-zone" data-display-element-id="previewSignatureImagedrag">
              <span class="drop-zone__prompt">Drop file here or click to upload</span>
              <input type="file" name="myFile" class="drop-zone__input" id="dragsignature">
            </div>
          </div>
          </div>
        </div>
        <div
          class="col-md-8  d-flex justify-content-evenly align-content-center display-container"
        >
          <div id="idCard" class="id-card position-relative">
            <img src="./images/FRONT.png" alt="" class="bg" />
            <img
              id="previewStudentImage"
              class="profile-image"
              src="./images/student.png"
              alt="Profile Image"
            />
            <div class="name">
              <h2 id="displayname"></h2>
            </div>
            <div class="course-container">
              <h2 id="displaycourse"></h2>
            </div>
            <div class="idnumber-container">
              <p id="studentID"></p>
            </div>
            <div class="sig-con">
              <img
                src="./images/signaturesample-removebg-preview.png"
                alt="signature"
                class="previewSignatureImage"
                id="previewSignatureImage"
              />
            </div>
            <button
              class="btn position-absolute exportfront"
              onclick="exportAsImage()"
            >
              Export Front
            </button>
          </div>

          <div id="backid" class="id-card position-relative ">
            <img src="images/BACK.png" alt="" class="bg-back" />
            <div class="school-year-container">
              <p class="display-school-year" id="display-school-year">
                A.Y. 2023-2024
              </p>
              <p class="display-semester" id="display-semester">
                First Semester
              </p>
            </div>
            <div class="guardian-details">
              <p class="guardianname" id="guardianname">Guardian's Name</p>
              <p>Mother</p>
              <p class="displaycontact" id="displaycontact">0912-345-6789</p>
            </div>
            <div class="birth-container">
              <p class="displaybirth" id="displaybirth"></p>
            </div>
            <button
              class="btn position-absolute exportback"
              onclick="exportAsImageBack()"
            >
              Export Back
            </button>
          </div>
        </div>
      </div>
    </div>
    <footer>
      <div class="container slideanim">
        <div class="row">
          <div class="col-sm-6  footer-logo mb-3">
            <a href="" class="link logo">Shanepai</a>
            <p>
              I'm a quick learner and adaptable junior full-stack web developer, eager to contribute my growing front-end expertise in Html,Css,Javascript,Bootstrap and back-end fundamentals in PHP using Laravel Framework. While I'm still building my portfolio, I'm highly motivated to learn from experienced professionals and tackle real-world projects like designing clean user interfaces, managing data, and ensuring seamless integration. I'm confident that my passion and dedication will be valuable assets to your team.
            </p>
            <p>Â©Shanepai 2023. All rights reserved</p>
          </div>
        
          <div class="col">
            <ul class="list-unstyled footer-list">
              <li class="list-title"><strong>Contacts</strong></li>
              <li>shaneenriquez50@gmail.com</li>
              <li>0991-373-1732</li>
            </ul>
          </div>
          <div class="col">
            <p style="margin-bottom: 36px;"><strong>Social Media</strong></p>
            <ul class="list-unstyled footer-list d-flex gap-3">
              <li><a href="https://www.facebook.com/pee.poy.98" target="_blank"><h4><i class="bi bi-facebook"></i></h4></i></a></li>
              <li><a href="https://github.com/shanepai-14" class="link" target="_blank"><h4><i class="bi bi-github"></i></h4></a></li>
              <li><a href="" class="link" target="_blank"><h4><i class="bi bi-linkedin"></i></h4></a></li>
            </ul>
          </div>
        </div>
      </div>
    </footer>

   
    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog shadow">
        <div class="modal-content">
          <div class="modal-header">
            <h1 class="modal-title fs-5" id="exampleModalLabel">Instruction</h1>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
          <ul >
            <li class="mb-2">Mandatory Information: Ensure that all required input fields are filled before exporting. The application will prevent exporting if any mandatory fields are empty.</li>
            <li >Image Background Removal: Remember to remove image backgrounds using <a href="https://www.remove.bg/upload" target="_blank">remove.bg</a> before uploading to ensure a professional-looking ID card.</li>
          </ul>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          
          </div>
        </div>
      </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <script>
      var fullname = document.getElementById("fullname");
      var displayname = document.getElementById("displayname");
      var idnumber = document.getElementById("idnumber");
      var studentID = document.getElementById("studentID");
      var studentImage = document.getElementById("dragstudentimage");
      var  signatureImage= document.getElementById("dragsignature");
      var previewStudentImage = document.getElementById("previewStudentImage");
      var contactnumber = document.getElementById("contactnumber");
      var displaycontact = document.getElementById("displaycontact");
      var guardianname = document.getElementById("guardianname");
      var guardian = document.getElementById("guardian");
      var currentschoolyear = document.getElementById("school-year");
      var displaySchoolYear = document.getElementById("display-school-year");
      var displaysemester = document.getElementById("display-semester");
      var semester = document.getElementById("semester");
      var bday = document.getElementById("bday");
      var displaybirth = document.getElementById("displaybirth");
    
      var previewSignatureImage = document.getElementById(
        "previewSignatureImage"
      );
      var displaycourse = document.getElementById("displaycourse");
      var course = document.getElementById("course");

      bday.addEventListener("input", function () {
        // Update the content of the output element in real-time
        displaybirth.textContent = bday.value;
      });
      semester.addEventListener("input", function () {
        // Update the content of the output element in real-time
        displaysemester.textContent = semester.value;
      });
      currentschoolyear.addEventListener("input", function () {
        // Update the content of the output element in real-time
        displaySchoolYear.textContent = "A.Y. " + currentschoolyear.value;
      });

      course.addEventListener("input", function () {
        // Update the content of the output element in real-time
        displaycourse.textContent = course.value;
      });
      fullname.addEventListener("input", function () {
        // Update the content of the output element in real-time
        displayname.textContent = fullname.value;
      });
      idnumber.addEventListener("input", function () {
        // Update the content of the output element in real-time
        studentID.textContent = "ID No.: " + idnumber.value;
      });
      contactnumber.addEventListener("input", function () {
        // Update the content of the output element in real-time
        displaycontact.textContent = contactnumber.value;
      });
      guardian.addEventListener("input", function () {
        // Update the content of the output element in real-time
        guardianname.textContent = guardian.value;
      });

      studentImage.addEventListener("change", function () {
        // Check if a file is selected
        if (studentImage.files && studentImage.files[0]) {
          // Create a FileReader to read the selected file
          var reader = new FileReader();

          // Set up the FileReader to update the image source when the file is loaded
          reader.onload = function (e) {
            previewStudentImage.src = e.target.result;
          };

          // Read the selected file as a data URL
          reader.readAsDataURL(studentImage.files[0]);
        } else {
          // If no file is selected, display the default image
          previewStudentImage.src = "./images/student.png";
        }
      });
      signatureImage.addEventListener("change", function () {
        // Check if a file is selected
        if (signatureImage.files && signatureImage.files[0]) {
          // Create a FileReader to read the selected file
          var reader = new FileReader();

          // Set up the FileReader to update the image source when the file is loaded
          reader.onload = function (e) {
            // previewSignatureImage.src = e.target.result;
            var imageSource = e.target.result;

            // Call the enhanceAndDisplay function with the image source
            enhanceAndDisplay(imageSource);
          };

          // Read the selected file as a data URL
          reader.readAsDataURL(signatureImage.files[0]);
        } else {
          // If no file is selected, display the default image
          previewSignatureImage.src = "./images/student.png";
        }
      });
      function saveFormData() {
        var schoolYearInput = document.getElementById("school-year");
        var semesterInput = document.getElementById("semester");
        var courseInput = document.getElementById("course");

        // Validate school-year format (e.g., 2023-2024)
        var schoolYearPattern = /^\d{4}-\d{4}$/;
        if (!schoolYearPattern.test(schoolYearInput.value)) {
          console.log("invalid school-year format");
          return; // Do not save if the format is invalid
        }

        // Save data to local storage

        localStorage.setItem("schoolYear", schoolYearInput.value);
        localStorage.setItem("semester", semesterInput.value);
        localStorage.setItem("course", courseInput.value);
        console.log("Form data saved!");
      }
      function loadFormData() {
        var schoolYearInput = document.getElementById("school-year");
        var semesterInput = document.getElementById("semester");
        var courseInput = document.getElementById("course");

        // Load data from local storage
        console.log(schoolYearInput.value);
        schoolYearInput.value = localStorage.getItem("schoolYear") || "";
        semesterInput.value =
          localStorage.getItem("semester") || "First Semester";

        courseInput.value =
          localStorage.getItem("course") || "BS - Information Technology";
        displaySchoolYear.textContent =
          "A.Y. " + localStorage.getItem("schoolYear") || "";
        displaysemester.textContent =
          localStorage.getItem("semester") || "First Semester";
        displaycourse.textContent =
          localStorage.getItem("course") || "BS - Information Technology";
      }

      document
        .getElementById("school-year")
        .addEventListener("input", saveFormData);
      document
        .getElementById("semester")
        .addEventListener("input", saveFormData);
      document.getElementById("course").addEventListener("input", saveFormData);

      loadFormData();
      // Student data (replace this with actual data)

      function enhanceAndDisplay(imageSource) {
        // Create an image object to work with
        var image = new Image();
        image.src = imageSource;

        image.onload = function () {
          // Enhance the signature
          var enhancedDataURL = enhanceSignature(image);

          // Display the enhanced image in another img tag
          var enhancedSignatureImage = document.getElementById(
            "previewSignatureImage"
          );
          enhancedSignatureImage.src = enhancedDataURL;
        };
      }
      //orginal
      // function enhanceSignature(image) {
      //   var canvas = document.createElement("canvas");
      //   var ctx = canvas.getContext("2d");
      //   canvas.width = image.width;
      //   canvas.height = image.height;

      //   // Draw the image on the canvas
      //   ctx.drawImage(image, 0, 0, canvas.width, canvas.height);

      //   // Get image data
      //   var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      //   var data = imageData.data;

      //   // Enhance signature lines (by making it more black)
      //   for (var i = 0; i < data.length; i += 4) {
      //           if (data[i + 3] > 0) {
      //               // If the pixel is not transparent, add stroke by modifying RGB values
      //               data[i] = 0;   // Red
      //               data[i + 1] = 0; // Green
      //               data[i + 2] = 0; // Blue
      //           }
      //       }

      //   // Put the modified image data back to the canvas
      //   ctx.drawImage(image, 1, 1, canvas.width, canvas.height);
      //   ctx.drawImage( imageData, 1, 1, canvas.width, canvas.height);
      //   ctx.drawImage(image, 1, 1, canvas.width, canvas.height);
      //   ctx.putImageData(imageData, 0, 0);

      //   return canvas.toDataURL("image/png");
      // }

      // function enhanceSignature(image) {
      //   // Create a canvas to work with
      //   var canvas = document.createElement("canvas");
      //   var ctx = canvas.getContext("2d");
      //   canvas.width = image.width;
      //   canvas.height = image.height;

      //   // Draw the original image on the canvas
      //   ctx.drawImage(image, 0, 0, canvas.width, canvas.height);

      //   // Get image data
      //   var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      //   var data = imageData.data;

      //   // Enhance signature lines (by making it more black)
      //   for (var i = 0; i < data.length; i += 4) {
      //     if (data[i + 3] > 0) {
      //       // If the pixel is not transparent, make it completely black
      //       data[i] = 0; // Red
      //       data[i + 1] = 0; // Green
      //       data[i + 2] = 0; // Blue
      //     }
      //   }

      //   // Put the modified image data back to the canvas
      //   ctx.putImageData(imageData, 0, 0);

      //   // Create a temporary canvas to simulate a thicker stroke
      //   var tempCanvas = document.createElement("canvas");
      //   var tempCtx = tempCanvas.getContext("2d");
      //   tempCanvas.width = image.width;
      //   tempCanvas.height = image.height;

      //   // Draw the modified image on the temporary canvas with an offset to simulate a thicker stroke
      //   tempCtx.drawImage(canvas, 1, 1, canvas.width, canvas.height);
      //   ctx.drawImage(tempCanvas, 0, 0, canvas.width, canvas.height);
      //   // Draw the modified image on the main canvas again to cover the original lines
      //   ctx.drawImage(tempCanvas, 1, 1, canvas.width, canvas.height);

      //   return canvas.toDataURL("image/png");
      // }

      //       function enhanceSignature(image) {
      //   // Create a canvas to work with
      //   var canvas = document.createElement("canvas");
      //   var ctx = canvas.getContext("2d");
      //   canvas.width = image.width;
      //   canvas.height = image.height;

      //   // Draw the original image on the canvas
      //   ctx.drawImage(image, 0, 0, canvas.width, canvas.height);

      //   // Get image data
      //   var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
      //   var data = imageData.data;

      //   // Find the non-transparent boundaries of the image
      //   var minX = canvas.width;
      //   var minY = canvas.height;
      //   var maxX = -1;
      //   var maxY = -1;

      //   for (var y = 0; y < canvas.height; y++) {
      //     for (var x = 0; x < canvas.width; x++) {
      //       var index = (y * canvas.width + x) * 4;

      //       if (data[index + 3] > 0) {
      //         minX = Math.min(minX, x);
      //         minY = Math.min(minY, y);
      //         maxX = Math.max(maxX, x);
      //         maxY = Math.max(maxY, y);
      //       }
      //     }
      //   }

      //   // Calculate the width and height of the non-transparent region
      //   var width = maxX - minX + 1;
      //   var height = maxY - minY + 1;

      //   // Create a new canvas with the dimensions of the non-transparent region
      //   var croppedCanvas = document.createElement("canvas");
      //   var croppedCtx = croppedCanvas.getContext("2d");
      //   croppedCanvas.width = width;
      //   croppedCanvas.height = height;

      //   // Draw the non-transparent region onto the new canvas
      //   croppedCtx.drawImage(
      //     canvas,
      //     minX,
      //     minY,
      //     width,
      //     height,
      //     0,
      //     0,
      //     width,
      //     height
      //   );

      //   // Enhance signature lines on the cropped image (by making it more black)
      //   var croppedImageData = croppedCtx.getImageData(0, 0, width, height);
      //   var croppedData = croppedImageData.data;

      //   for (var i = 0; i < croppedData.length; i += 4) {
      //     if (croppedData[i + 3] > 0) {
      //       croppedData[i] = 0; // Red
      //       croppedData[i + 1] = 0; // Green
      //       croppedData[i + 2] = 0; // Blue
      //     }
      //   }

      //   // Put the modified image data back to the cropped canvas

      //   // Return the enhanced and cropped image as a data URL
      //   return croppedCanvas.toDataURL("image/png");
      // }
      function enhanceSignature(image) {
        // Create a canvas to work with
        var canvas = document.createElement("canvas");
        var ctx = canvas.getContext("2d");
        canvas.width = image.width;
        canvas.height = image.height;

        // Draw the original image on the canvas
        ctx.drawImage(image, 0, 0, canvas.width, canvas.height);

        // Get image data
        var imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
        var data = imageData.data;

        // Find the non-transparent boundaries of the image
        var minX = canvas.width;
        var minY = canvas.height;
        var maxX = -1;
        var maxY = -1;

        for (var y = 0; y < canvas.height; y++) {
          for (var x = 0; x < canvas.width; x++) {
            var index = (y * canvas.width + x) * 4;

            if (data[index + 3] > 0) {
              minX = Math.min(minX, x);
              minY = Math.min(minY, y);
              maxX = Math.max(maxX, x);
              maxY = Math.max(maxY, y);
            }
          }
        }

        // Calculate the width and height of the non-transparent region
        var width = maxX - minX + 1;
        var height = maxY - minY + 1;

        // Create a new canvas with the dimensions of the non-transparent region
        var croppedCanvas = document.createElement("canvas");
        var croppedCtx = croppedCanvas.getContext("2d");
        croppedCanvas.width = width;
        croppedCanvas.height = height;

        // Draw the non-transparent region onto the new canvas
        croppedCtx.drawImage(
          canvas,
          minX,
          minY,
          width,
          height,
          0,
          0,
          width,
          height
        );

        // Enhance signature lines on the cropped image (by making it more black)
        var croppedImageData = croppedCtx.getImageData(0, 0, width, height);
        var croppedData = croppedImageData.data;

        for (var i = 0; i < croppedData.length; i += 4) {
          if (croppedData[i + 3] > 0) {
            croppedData[i] = 0; // Red
            croppedData[i + 1] = 0; // Green
            croppedData[i + 2] = 0; // Blue
          }
        }

        // Put the modified image data back to the cropped canvas
        croppedCtx.putImageData(croppedImageData, 0, 0);

        // Create a temporary canvas to simulate a thicker stroke
        var tempCanvas = document.createElement("canvas");
        var tempCtx = tempCanvas.getContext("2d");
        tempCanvas.width = width;
        tempCanvas.height = height;

        // Draw the cropped image on the temporary canvas with an offset to simulate a thicker stroke
        tempCtx.drawImage(croppedCanvas, 1, 1, width - 2, height - 2);
        croppedCtx.drawImage(tempCanvas, 0, 0, width, height);

        // Draw the modified image on the main canvas again to cover the original lines
        croppedCtx.drawImage(tempCanvas, 1, 1, width - 2, height - 2);
        croppedCtx.drawImage(tempCanvas, 3, 3, width - 2, height - 2);
        croppedCtx.drawImage(tempCanvas, 4, 4, width - 2, height - 2);
        // Return the enhanced and duplicated image as a data URL
        return croppedCanvas.toDataURL("image/png");
      }

      // Replace with the actual path

      // Update other fields as needed
      function coursefilename(courselected){
 
        if(courselected == 'BS - Information Technology'){
          return '-BSIT';
        }
        if(courselected == 'B - Secondary Education'){
          return '-BSED';
        }
        if(courselected == 'B - Elementary Education'){
          return '-BEED';
        }
        if(courselected == 'B - Arts in Theology'){
          return '-ABTHEO';
        }

      }

      function exportAsImage() {
        html2canvas(document.getElementById("idCard"), { scale: 3 }).then(
          function (canvas) {
            var img = canvas.toDataURL("image/png");
            var link = document.createElement("a");
            var currentcourse = course.value;
            var finalcourse =  coursefilename(currentcourse);
            
            link.href = img;
            link.download = `${fullname.value +finalcourse+"-FRONT"}.png`;
            link.click();
          }
        );
      }
      function exportAsImageBack() {
        html2canvas(document.getElementById("backid"), { scale: 3 }).then(
          function (canvas) {
            var img = canvas.toDataURL("image/png");
            var link = document.createElement("a");
            var currentcourse = course.value;
            var finalcourse =  coursefilename(currentcourse);
            link.href = img;
            link.download = `${fullname.value +finalcourse+ "-BACK"}.png`;
            link.click();
          }
        );
      }
      function isAlphabetic(event) {
        // Check if the pressed key is an alphabetic character
        return (
          /[a-zA-Z]/.test(event.key) || event.key === " " || event.key === "."
        );
      }

      function validatePhoneNumber(event) {
        var input = event.target;
        var pattern = /^\d{0,4}-\d{0,3}-\d{0,4}$/;

        if (!pattern.test(input.value)) {
          // Clear the input if it doesn't match the pattern
          input.setCustomValidity(
            "Invalid phone number format. Please use the format: 0932-232-2323"
          );
          return false; // Prevent the input
        } else {
          input.setCustomValidity(""); // Reset custom validity
          return true; // Allow the input
        }
      }
      function validateBirthday(event) {
        var input = event.target;
        var pattern = /^[a-zA-Z]+\s\d{1,2},\s\d{4}$/;

        if (!pattern.test(input.value)) {
          input.setCustomValidity(
            "Invalid birthday format. Please use the format: Month day, year"
          );
        } else {
          input.setCustomValidity("");
        }
      }
      // window.onload = enhanceAndDisplay;
    </script>
    
    <script>
      document.querySelectorAll(".drop-zone__input").forEach((inputElement) => {
  const dropZoneElement = inputElement.closest(".drop-zone");
  const displayElementId = dropZoneElement.dataset.displayElementId;
  dropZoneElement.addEventListener("click", (e) => {
    inputElement.click();
  });

  inputElement.addEventListener("change", (e) => {
    if (inputElement.files.length) {
      updateThumbnail(dropZoneElement, inputElement.files[0]);
    }
  });

  dropZoneElement.addEventListener("dragover", (e) => {
    e.preventDefault();
    dropZoneElement.classList.add("drop-zone--over");
  });

  ["dragleave", "dragend"].forEach((type) => {
    dropZoneElement.addEventListener(type, (e) => {
      dropZoneElement.classList.remove("drop-zone--over");
    });
  });

  dropZoneElement.addEventListener("drop", (e) => {
    e.preventDefault();

    if (e.dataTransfer.files.length) {
      inputElement.files = e.dataTransfer.files;
      updateThumbnail(dropZoneElement, e.dataTransfer.files[0],displayElementId);
    }

    dropZoneElement.classList.remove("drop-zone--over");
  });
});

/**
 * Updates the thumbnail on a drop zone element.
 *
 * @param {HTMLElement} dropZoneElement
 * @param {File} file
 */
function updateThumbnail(dropZoneElement, file,displayElementId) {
  let thumbnailElement = dropZoneElement.querySelector(".drop-zone__thumb");

  // First time - remove the prompt
  if (dropZoneElement.querySelector(".drop-zone__prompt")) {
    dropZoneElement.querySelector(".drop-zone__prompt").remove();
  }

  // First time - there is no thumbnail element, so lets create it
  if (!thumbnailElement) {
    thumbnailElement = document.createElement("div");
    thumbnailElement.classList.add("drop-zone__thumb");
    dropZoneElement.appendChild(thumbnailElement);
  }

  thumbnailElement.dataset.label = file.name;

  // Show thumbnail for image files
  if (file.type.startsWith("image/")) {
    const reader = new FileReader();

    reader.readAsDataURL(file);
    reader.onload = () => {
      
      thumbnailElement.style.backgroundImage = `url('${reader.result}')`;
      if(displayElementId =='previewStudentImagedrag'){
        previewStudentImage.src = reader.result;
      }
      if(displayElementId =='previewSignatureImagedrag'){
        enhanceAndDisplay(reader.result);
      }
      
    };
  } else {
    thumbnailElement.style.backgroundImage = null;
  }
}
$(window).on('load', function() {
  $('#exampleModal').modal('show');
});
    </script>
  </body>
</html>
